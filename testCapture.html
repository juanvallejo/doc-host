<!doctype html>
<html>
<head>
	<meta charset="utf-8" />
	<title></title>
</head>
<body>
<video id="videoElement" autoplay="true"></video>
</body>
<script>
function onLoad() {
// paste the following in the chrome console
var video = document.querySelector("#videoElement");
 
navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;
 
if (navigator.getUserMedia) {       
    navigator.getUserMedia({video: true}, handleVideo, videoError);
}
 
function handleVideo(stream) {
    video.src = window.URL.createObjectURL(stream);
}

function videoError(e) {

}

function captureImage(scale, callback) {

	callback = callback || function() {};

	console.log(video.videoWidth);
	var canvas = document.createElement("canvas");
    canvas.width = video.videoWidth * scale;
    canvas.height = video.videoHeight * scale;
    canvas.getContext('2d')
          .drawImage(video, 0, 0, canvas.width, canvas.height);

    var img = document.createElement("img");
    img.src = canvas.toDataURL();

    img.addEventListener('load', function() {
    	callback.call(this, img);
    });
}

video.addEventListener('click', function() {
	console.log('test');
	captureImage(1, function(img) {
		console.log(img);
		document.body.appendChild(img);
	});
});

} // onLoad

onLoad();
</script>
</html>